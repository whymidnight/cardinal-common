{"version":3,"file":"mints.js","sourceRoot":"","sources":["../../src/mints.ts"],"names":[],"mappings":";;;;AACA,iDAQ2B;AAM3B,6CAAsE;AAEtE,iDAAoD;AAEpD;;;;;;GAMG;AACI,MAAM,UAAU,GAAG,CACxB,UAAsB,EACtB,MAAc,EACd,MAAmB,EACc,EAAE;IACnC,MAAM,WAAW,GAAG,iBAAO,CAAC,QAAQ,EAAE,CAAC;IACvC,MAAM,MAAM,GAAG,WAAW,CAAC,SAAS,CAAC;IACrC,MAAM,CAAC,EAAE,EAAE,GAAG,CAAC,GAAG,MAAM,IAAA,oBAAY,EAClC,UAAU,EACV,WAAW,CAAC,SAAS,EACrB,MAAM,CAAC,SAAS,EAChB,MAAM,CACP,CAAC;IACF,MAAM,IAAA,iCAAkB,EAAC,UAAU,EAAE,EAAE,EAAE,MAAM,EAAE,EAAE,OAAO,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;IAC7E,OAAO,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;AACvB,CAAC,CAAA,CAAC;AAfW,QAAA,UAAU,cAerB;AAQF;;;;;;;GAOG;AACI,MAAM,YAAY,GAAG,CAC1B,UAAsB,EACtB,MAAiB,EACjB,SAAoB,EACpB,MAAmB,EACgB,EAAE;IACrC,MAAM,CAAC,GAAG,EAAE,GAAG,CAAC,GAAG,MAAM,IAAA,qBAAa,EAAC,UAAU,EAAE,MAAM,EAAE,SAAS,EAAE,MAAM,CAAC,CAAC;IAC9E,MAAM,EAAE,GAAG,IAAI,qBAAW,EAAE,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC,CAAC;IACzC,OAAO,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC;AACnB,CAAC,CAAA,CAAC;AATW,QAAA,YAAY,gBASvB;AAEF;;;;;;;GAOG;AACI,MAAM,aAAa,GAAG,CAC3B,UAAsB,EACtB,MAAiB,EACjB,SAAoB,EACpB,MAAmB,EAC6B,EAAE;;IAClD,MAAM,MAAM,GAAG,MAAA,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,MAAM,mCAAI,SAAS,CAAC;IAC3C,MAAM,GAAG,GAAG,IAAA,yCAA6B,EAAC,MAAM,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;IAChE,OAAO;QACL;YACE,uBAAa,CAAC,aAAa,CAAC;gBAC1B,UAAU,EAAE,SAAS;gBACrB,gBAAgB,EAAE,MAAM;gBACxB,KAAK,EAAE,qBAAS;gBAChB,QAAQ,EAAE,MAAM,IAAA,8CAAkC,EAAC,UAAU,CAAC;gBAC9D,SAAS,EAAE,4BAAgB;aAC5B,CAAC;YACF,IAAA,4CAAgC,EAC9B,MAAM,EACN,MAAA,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,QAAQ,mCAAI,CAAC,EACrB,SAAS,EACT,SAAS,CACV;YACD,IAAA,mDAAuC,EAAC,SAAS,EAAE,GAAG,EAAE,MAAM,EAAE,MAAM,CAAC;YACvE,IAAA,mCAAuB,EAAC,MAAM,EAAE,GAAG,EAAE,SAAS,EAAE,MAAA,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,MAAM,mCAAI,CAAC,CAAC;SACrE;QACD,GAAG;KACJ,CAAC;AACJ,CAAC,CAAA,CAAC;AA5BW,QAAA,aAAa,iBA4BxB","sourcesContent":["import type { Wallet } from \"@project-serum/anchor/dist/cjs/provider\";\nimport {\n  createAssociatedTokenAccountInstruction,\n  createInitializeMint2Instruction,\n  createMintToInstruction,\n  getAssociatedTokenAddressSync,\n  getMinimumBalanceForRentExemptMint,\n  MINT_SIZE,\n  TOKEN_PROGRAM_ID,\n} from \"@solana/spl-token\";\nimport type {\n  Connection,\n  PublicKey,\n  TransactionInstruction,\n} from \"@solana/web3.js\";\nimport { Keypair, SystemProgram, Transaction } from \"@solana/web3.js\";\n\nimport { executeTransaction } from \"./transactions\";\n\n/**\n * Build and execute mint Tx\n * @param connection\n * @param wallet\n * @param config\n * @returns\n */\nexport const createMint = async (\n  connection: Connection,\n  wallet: Wallet,\n  config?: MintConfig\n): Promise<[PublicKey, PublicKey]> => {\n  const mintKeypair = Keypair.generate();\n  const mintId = mintKeypair.publicKey;\n  const [tx, ata] = await createMintTx(\n    connection,\n    mintKeypair.publicKey,\n    wallet.publicKey,\n    config\n  );\n  await executeTransaction(connection, tx, wallet, { signers: [mintKeypair] });\n  return [ata, mintId];\n};\n\nexport type MintConfig = {\n  target?: PublicKey;\n  amount?: number;\n  decimals?: number;\n};\n\n/**\n * Transaction for creating a mint\n * @param connection\n * @param mintId\n * @param authority\n * @param config\n * @returns\n */\nexport const createMintTx = async (\n  connection: Connection,\n  mintId: PublicKey,\n  authority: PublicKey,\n  config?: MintConfig\n): Promise<[Transaction, PublicKey]> => {\n  const [ixs, ata] = await createMintIxs(connection, mintId, authority, config);\n  const tx = new Transaction().add(...ixs);\n  return [tx, ata];\n};\n\n/**\n * Instructions for creating a mint\n * @param connection\n * @param mintId\n * @param authority\n * @param config\n * @returns\n */\nexport const createMintIxs = async (\n  connection: Connection,\n  mintId: PublicKey,\n  authority: PublicKey,\n  config?: MintConfig\n): Promise<[TransactionInstruction[], PublicKey]> => {\n  const target = config?.target ?? authority;\n  const ata = getAssociatedTokenAddressSync(mintId, target, true);\n  return [\n    [\n      SystemProgram.createAccount({\n        fromPubkey: authority,\n        newAccountPubkey: mintId,\n        space: MINT_SIZE,\n        lamports: await getMinimumBalanceForRentExemptMint(connection),\n        programId: TOKEN_PROGRAM_ID,\n      }),\n      createInitializeMint2Instruction(\n        mintId,\n        config?.decimals ?? 0,\n        authority,\n        authority\n      ),\n      createAssociatedTokenAccountInstruction(authority, ata, target, mintId),\n      createMintToInstruction(mintId, ata, authority, config?.amount ?? 1),\n    ],\n    ata,\n  ];\n};\n"]}